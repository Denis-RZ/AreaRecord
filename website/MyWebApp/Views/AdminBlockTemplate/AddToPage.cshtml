@using MyWebApp.Models
@{
    ViewData["Title"] = "Add Block To Page";
    Layout = "../Admin/_AdminLayout";
}
<h2>@ViewData["Title"]</h2>
<form asp-action="AddToPage" method="post">
    <input type="hidden" name="id" value="@ViewBag.BlockId" />
    <div>
        <label>Associated Page(s)</label>
        <input type="text" id="page-display" readonly />
    </div>
    <div>
        <label>Assign To Pages</label>
        <select id="page-select" name="pageIds" multiple size="5">
            <option value="0">All Pages</option>
            @foreach (var p in ViewBag.Pages as List<Page>)
            {
                <option value="@p.Id">@p.Slug</option>
            }
        </select>
    </div>
    <div>
        <label>Zone</label>
        <input type="text" name="zone" />
    </div>
    <div>
        <label>Role</label>
        <select name="role">
            <option value="">(none)</option>
            @foreach (var r in ViewBag.Roles as List<Role>)
            {
                <option value="@r.Name">@r.Name</option>
            }
        </select>
    </div>
    <button type="submit">Add</button>
</form>

@section Scripts {
    <script>
        const select = document.getElementById('page-select');
        const display = document.getElementById('page-display');
        function updateDisplay() {
            const names = Array.from(select.selectedOptions).map(o => o.text);
            display.value = names.join(', ');
        }
        select.addEventListener('change', updateDisplay);
        updateDisplay();
    </script>
}
